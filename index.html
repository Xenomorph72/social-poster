<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FILM426 Social Poster Pro</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <style>
    :root {
      --bg-deep: #0a0a0f;
      --bg-card: #14141f;
      --bg-input: #1a1a2e;
      --border-subtle: #2a2a3e;
      --border-active: #3a3a4e;
      --accent-cyan: #00d4ff;
      --accent-orange: #ff6b35;
      --accent-green: #00c853;
      --text-primary: #ffffff;
      --text-secondary: #a0a0b0;
      --text-muted: #606070;
    }
    
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg-deep);
      color: var(--text-secondary);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container { max-width: 1400px; margin: 0 auto; }
    
    header {
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border-subtle);
    }
    
    h1 {
      color: var(--text-primary);
      font-size: 1.75rem;
      margin-bottom: 4px;
    }
    
    .subtitle { color: var(--text-muted); font-size: 0.9375rem; }
    
    /* Campaign Selection */
    .campaign-section {
      background: var(--bg-card);
      border: 1px solid var(--border-subtle);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 24px;
    }
    
    .campaign-section h2 {
      color: var(--text-primary);
      font-size: 1.125rem;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .campaign-section h2::before { content: "üìã"; }
    
    .campaign-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    
    .campaign-item {
      background: var(--bg-input);
      border: 1px solid var(--border-subtle);
      border-radius: 10px;
      padding: 16px 20px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .campaign-item:hover {
      border-color: var(--accent-cyan);
      transform: translateX(4px);
    }
    
    .campaign-item.active {
      border-color: var(--accent-cyan);
      background: rgba(0, 212, 255, 0.05);
      box-shadow: 0 0 20px rgba(0, 212, 255, 0.1);
    }
    
    .campaign-info h3 {
      color: var(--text-primary);
      font-size: 1rem;
      margin-bottom: 4px;
    }
    
    .campaign-meta {
      font-size: 0.8125rem;
      color: var(--text-muted);
    }
    
    .campaign-status {
      font-size: 0.75rem;
      padding: 4px 12px;
      border-radius: 20px;
      font-weight: 600;
    }
    
    .campaign-status.ready {
      background: rgba(0, 200, 83, 0.15);
      color: var(--accent-green);
    }
    
    .campaign-status.loaded {
      background: rgba(0, 212, 255, 0.15);
      color: var(--accent-cyan);
    }
    
    /* Week Grid */
    .week-section {
      background: var(--bg-card);
      border: 1px solid var(--border-subtle);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 24px;
    }
    
    .week-section h2 {
      color: var(--text-primary);
      font-size: 1.125rem;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .week-section h2::before { content: "üìÖ"; }
    
    .week-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 12px;
    }
    
    .day-card {
      background: var(--bg-input);
      border: 1px solid var(--border-subtle);
      border-radius: 10px;
      padding: 16px;
      min-height: 140px;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .day-card:hover {
      border-color: var(--accent-cyan);
      transform: translateY(-2px);
    }
    
    .day-card.active {
      border-color: var(--accent-cyan);
      background: rgba(0, 212, 255, 0.05);
      box-shadow: 0 0 20px rgba(0, 212, 255, 0.15);
    }
    
    .day-card.used {
      opacity: 0.5;
      border-color: var(--border-subtle);
    }
    
    .day-card.empty {
      opacity: 0.3;
      cursor: not-allowed;
    }
    
    .day-name {
      font-size: 0.75rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .day-date {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--text-primary);
      margin: 4px 0;
    }
    
    .post-type {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 0.6875rem;
      font-weight: 600;
      text-transform: uppercase;
      margin-top: 8px;
    }
    
    .post-type.teaser { background: rgba(255, 171, 0, 0.15); color: #ffab00; }
    .post-type.announce { background: rgba(255, 107, 53, 0.15); color: var(--accent-orange); }
    .post-type.release { background: rgba(0, 200, 83, 0.15); color: var(--accent-green); }
    .post-type.behind { background: rgba(137, 87, 229, 0.15); color: #8957e5; }
    .post-type.followup { background: rgba(0, 212, 255, 0.15); color: var(--accent-cyan); }
    .post-type.reminder { background: rgba(160, 160, 176, 0.15); color: var(--text-secondary); }
    .post-type.poll { background: rgba(163, 113, 247, 0.15); color: #a371f7; }
    
    .day-status {
      font-size: 0.6875rem;
      color: var(--accent-cyan);
      margin-top: 8px;
      font-weight: 500;
    }
    
    /* Post Editor */
    .post-editor {
      background: var(--bg-card);
      border: 1px solid var(--border-subtle);
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 24px;
      display: none;
    }
    
    .post-editor.active { display: block; }
    
    .editor-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border-subtle);
    }
    
    .editor-title {
      color: var(--text-primary);
      font-size: 1.125rem;
    }
    
    .close-btn {
      padding: 8px 16px;
      background: transparent;
      border: 1px solid var(--border-subtle);
      border-radius: 6px;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .close-btn:hover {
      border-color: var(--accent-orange);
      color: var(--accent-orange);
    }
    
    .posts-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
    }
    
    .post-box {
      background: var(--bg-input);
      border: 1px solid var(--border-subtle);
      border-radius: 10px;
      padding: 16px;
    }
    
    .post-box h3 {
      color: var(--accent-cyan);
      font-size: 0.875rem;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .post-box textarea {
      width: 100%;
      height: 200px;
      padding: 12px;
      background: var(--bg-deep);
      border: 1px solid var(--border-subtle);
      border-radius: 8px;
      color: var(--text-primary);
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8125rem;
      line-height: 1.6;
      resize: vertical;
      transition: all 0.2s;
    }
    
    .post-box textarea:focus {
      outline: none;
      border-color: var(--accent-cyan);
    }
    
    .char-count {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 8px;
      text-align: right;
    }
    
    .editor-actions {
      display: flex;
      gap: 12px;
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid var(--border-subtle);
    }
    
    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 0.875rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .btn-copy {
      background: transparent;
      border: 1px solid var(--border-subtle);
      color: var(--text-secondary);
    }
    
    .btn-copy:hover {
      border-color: var(--accent-cyan);
      color: var(--accent-cyan);
    }
    
    .btn-archive {
      background: var(--accent-orange);
      color: white;
    }
    
    .btn-archive:hover {
      transform: translateY(-1px);
      box-shadow: 0 0 20px rgba(255, 107, 53, 0.3);
    }
    
    /* Archive */
    .archive-section {
      background: var(--bg-card);
      border: 1px solid var(--border-subtle);
      border-radius: 12px;
      padding: 20px;
    }
    
    .archive-section h2 {
      color: var(--text-primary);
      font-size: 1.125rem;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .archive-section h2::before { content: "üìÅ"; }
    
    .archive-list {
      max-height: 300px;
      overflow-y: auto;
    }
    
    .archive-item {
      background: var(--bg-input);
      border: 1px solid var(--border-subtle);
      border-radius: 8px;
      padding: 14px 16px;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .archive-meta {
      font-size: 0.75rem;
      color: var(--text-muted);
    }
    
    .archive-title {
      color: var(--text-primary);
      font-weight: 500;
    }
    
    /* Toast */
    .toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      padding: 14px 24px;
      background: var(--bg-card);
      border: 1px solid var(--border-subtle);
      border-left: 3px solid var(--accent-green);
      border-radius: 8px;
      color: var(--text-primary);
      opacity: 0;
      transform: translateY(10px);
      transition: all 0.3s;
      z-index: 1000;
    }
    
    .toast.show {
      opacity: 1;
      transform: translateY(0);
    }
    
    @media (max-width: 1024px) {
      .week-grid { grid-template-columns: repeat(4, 1fr); }
      .posts-grid { grid-template-columns: 1fr; }
    }
    
    @media (max-width: 768px) {
      .week-grid { grid-template-columns: repeat(2, 1fr); }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üéµ FILM426 Social Poster Pro</h1>
      <p class="subtitle">Campaign Manager</p>
    </header>
    
    <!-- Campaign Selection -->
    <div class="campaign-section">
      <h2>Available Campaigns</h2>
      <div class="campaign-list" id="campaign-list">
        <p style="color: var(--text-muted);">Loading campaigns...</p>
      </div>
    </div>
    
    <!-- Week Grid -->
    <div class="week-section" id="week-section" style="display: none;">
      <h2 id="week-title">Campaign Posts</h2>
      <div class="week-grid" id="week-grid">
        <!-- Days generated by JS -->
      </div>
    </div>
    
    <!-- Post Editor -->
    <div class="post-editor" id="post-editor">
      <div class="editor-header">
        <h2 class="editor-title" id="editor-title">Select a day</h2>
        <button class="close-btn" onclick="closeEditor()">Close</button>
      </div>
      
      <div class="posts-grid">
        <div class="post-box">
          <h3>üê¶ X / Threads</h3>
          <textarea id="x-post" placeholder="X/Threads post..."></textarea>
          <div class="char-count" id="x-count">0 / 280</div>
        </div>
        
        <div class="post-box">
          <h3>üì∏ Instagram / Facebook</h3>
          <textarea id="ig-post" placeholder="Instagram/Facebook post..."></textarea>
        </div>
        
        <div class="post-box">
          <h3>üé¨ TikTok / YouTube Shorts</h3>
          <textarea id="video-post" placeholder="TikTok/YouTube script..."></textarea>
        </div>
      </div>
      
      <div class="editor-actions">
        <button class="btn btn-copy" onclick="copyAll()">üìã Copy All</button>
        <button class="btn btn-archive" onclick="archiveDay()">üìÅ Archive & Clear</button>
      </div>
    </div>
    
    <!-- Archive -->
    <div class="archive-section">
      <h2>Archived Posts</h2>
      <div class="archive-list" id="archive-list">
        <p style="color: var(--text-muted);">No archived posts yet.</p>
      </div>
    </div>
  </div>
  
  <div class="toast" id="toast"></div>
  
  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyCPwmu7TwiF4j2DatPa1TjK8QF4YSHE",
      authDomain: "dash-clawd.firebaseapp.com",
      projectId: "dash-clawd",
      storageBucket: "dash-clawd.appspot.com",
      messagingSenderId: "123456789",
      appId: "1:123456789:web:xxxxxxxxxxxxxxxx"
    };
    
    let db;
    let campaigns = [];
    let currentCampaign = null;
    let currentDay = null;
    let weekData = {};
    let archive = JSON.parse(localStorage.getItem('socialArchive') || '[]');
    
    const typeLabels = {
      teaser: 'Teaser',
      behind: 'Behind',
      announce: 'Announce',
      release: 'Release',
      followup: 'Follow-up',
      reminder: 'Reminder',
      poll: 'Poll'
    };
    
    // Init
    async function init() {
      try {
        firebase.initializeApp(firebaseConfig);
        db = firebase.firestore();
        await loadCampaigns();
      } catch(e) {
        console.log('Firebase error, using local:', e);
        showLocalCampaigns();
      }
      renderArchive();
    }
    
    // Load campaigns from Firebase
    async function loadCampaigns() {
      const snapshot = await db.collection('socialCampaigns').get();
      campaigns = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
      
      if (campaigns.length === 0) {
        showLocalCampaigns();
      } else {
        renderCampaigns();
      }
    }
    
    // Show local campaigns (fallback)
    function showLocalCampaigns() {
      campaigns = JSON.parse(localStorage.getItem('socialCampaigns') || '[]');
      renderCampaigns();
    }
    
    // Render campaign list
    function renderCampaigns() {
      const list = document.getElementById('campaign-list');
      
      if (campaigns.length === 0) {
        list.innerHTML = '<p style="color: var(--text-muted);">No campaigns available. Bella will add them.</p>';
        return;
      }
      
      list.innerHTML = campaigns.map(c => `
        <div class="campaign-item ${currentCampaign?.id === c.id ? 'active' : ''}" onclick="selectCampaign('${c.id}')">
          <div class="campaign-info">
            <h3>${c.name}</h3>
            <div class="campaign-meta">${c.description || '7 posts ready'} ‚Ä¢ Created ${new Date(c.createdAt).toLocaleDateString()}</div>
          </div>
          <div class="campaign-status ${currentCampaign?.id === c.id ? 'loaded' : 'ready'}">
            ${currentCampaign?.id === c.id ? '‚úì Loaded' : 'Ready'}
          </div>
        </div>
      `).join('');
    }
    
    // Select campaign
    function selectCampaign(id) {
      currentCampaign = campaigns.find(c => c.id === id);
      weekData = currentCampaign.posts || {};
      
      document.getElementById('week-section').style.display = 'block';
      document.getElementById('week-title').textContent = currentCampaign.name;
      
      renderCampaigns();
      initWeekGrid();
      
      // Scroll to week
      document.getElementById('week-section').scrollIntoView({ behavior: 'smooth' });
    }
    
    // Render week grid
    function initWeekGrid() {
      const grid = document.getElementById('week-grid');
      grid.innerHTML = '';
      
      const today = new Date();
      
      for (let i = 0; i < 7; i++) {
        const date = new Date(today);
        date.setDate(today.getDate() + i);
        
        const dayKey = date.toISOString().split('T')[0];
        const dayName = date.toLocaleDateString('en-US', { weekday: 'short' });
        const dayNum = date.getDate();
        
        const dayData = weekData[dayKey] || {};
        const hasContent = dayData.x || dayData.ig;
        const isUsed = dayData.used;
        
        const card = document.createElement('div');
        card.className = `day-card ${hasContent ? '' : 'empty'} ${isUsed ? 'used' : ''}`;
        if (hasContent) {
          card.onclick = () => selectDay(dayKey, date);
        }
        
        card.innerHTML = `
          <div class="day-name">${dayName}</div>
          <div class="day-date">${dayNum}</div>
          ${dayData.type ? `<span class="post-type ${dayData.type}">${typeLabels[dayData.type]}</span>` : ''}
          ${hasContent ? '<div class="day-status">‚úì Ready</div>' : ''}
        `;
        
        grid.appendChild(card);
      }
    }
    
    // Select day
    function selectDay(dayKey, dateObj) {
      currentDay = dayKey;
      const dayData = weekData[dayKey] || {};
      
      document.getElementById('editor-title').textContent = 
        `${dateObj.toLocaleDateString('en-US', { weekday: 'long', month: 'short', day: 'numeric' })}` +
        (dayData.type ? ` ‚Äî ${typeLabels[dayData.type]}` : '');
      
      document.getElementById('x-post').value = dayData.x || '';
      document.getElementById('ig-post').value = dayData.ig || '';
      document.getElementById('video-post').value = dayData.video || '';
      
      updateCharCount();
      document.getElementById('post-editor').classList.add('active');
      document.getElementById('post-editor').scrollIntoView({ behavior: 'smooth' });
    }
    
    // Close editor
    function closeEditor() {
      document.getElementById('post-editor').classList.remove('active');
      currentDay = null;
    }
    
    // Copy all
    function copyAll() {
      const x = document.getElementById('x-post').value;
      const ig = document.getElementById('ig-post').value;
      const video = document.getElementById('video-post').value;
      
      const all = `=== X/THREADS ===\n${x}\n\n=== INSTAGRAM/FACEBOOK ===\n${ig}\n\n=== TIKTOK/YOUTUBE ===\n${video}`;
      
      navigator.clipboard.writeText(all).then(() => {
        showToast('Copied to clipboard!');
      });
    }
    
    // Archive day
    function archiveDay() {
      if (!currentDay) return;
      
      archive.unshift({
        ...weekData[currentDay],
        archivedAt: new Date().toISOString(),
        archivedDate: new Date().toLocaleDateString()
      });
      
      localStorage.setItem('socialArchive', JSON.stringify(archive));
      
      weekData[currentDay].used = true;
      closeEditor();
      initWeekGrid();
      renderArchive();
      showToast('Archived!');
    }
    
    // Render archive
    function renderArchive() {
      const list = document.getElementById('archive-list');
      if (archive.length === 0) {
        list.innerHTML = '<p style="color: var(--text-muted);">No archived posts yet.</p>';
        return;
      }
      
      list.innerHTML = archive.map(item => `
        <div class="archive-item">
          <div>
            <div class="archive-meta">${item.archivedDate}</div>
            <div class="archive-title">${typeLabels[item.type] || 'Post'}</div>
          </div>
        </div>
      `).join('');
    }
    
    // Update char count
    function updateCharCount() {
      const x = document.getElementById('x-post').value;
      document.getElementById('x-count').textContent = `${x.length} / 280`;
    }
    
    document.getElementById('x-post').addEventListener('input', updateCharCount);
    
    // Show toast
    function showToast(msg) {
      const toast = document.getElementById('toast');
      toast.textContent = msg;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 3000);
    }
    
    // Init
    init();
  </script>
</body>
</html>
